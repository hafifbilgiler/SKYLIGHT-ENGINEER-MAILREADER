apiVersion: apps/v1
kind: Deployment
metadata:
  name: skylight-engineer-mailreader-llm
  namespace: skylight-engineer-mailreader
spec:
  replicas: 1
  selector:
    matchLabels:
      app: skylight-engineer-mailreader-llm
  template:
    metadata:
      labels:
        app: skylight-engineer-mailreader-llm
    spec:
      containers:
      - name: llama-cpp
        image: ghcr.io/ggerganov/llama.cpp:latest
        command: ["llama-server"]
        args:
          - -m
          - /models/qwen2.5-7b-instruct-q4_k_m-00001-of-00002.gguf
          - --host
          - 0.0.0.0
          - --port
          - "8080"
          - -c
          - "4096"
          - --threads
          - "6"
          - --no-webui
        ports:
        - containerPort: 8080
        volumeMounts:
        - name: model-volume
          mountPath: /models
          readOnly: true
      volumes:
      - name: model-volume
        persistentVolumeClaim:
          claimName: skylight-engineer-mailreader-llm-model-pvc
